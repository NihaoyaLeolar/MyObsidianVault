---
tags:
  - 缓存
---
>用户**高并发重复请求**，若该数据在缓存和数据库中均没有，则**缓存永远不会生效**，那么**请求都会打到数据库**。会给数据库造成强大压力

![[CleanShot 2024-02-28 at 11.53.36@2x.png]]
当我们客户端访问不存在的数据时，先请求redis，但是此时redis中没有数据，就会访问到数据库。但是数据库中也没有数据，这个数据穿透了缓存，直击数据库。（数据库能够承载的并发不如redis这么高）
# 解决方案
---
## 1. 缓存空对象
哪怕这个数据在数据库中也不存在，我们也把空数据（创建一个空的：null/空串/null串都行）存入到redis中去。这样，下次用户过来访问这个不存在的数据，那么在redis中也能找到这个数据，就不会多次穿透到数据库查询了。
![[CleanShot 2024-02-28 at 11.50.28@2x.png|300]]
### 优缺点分析
- 优点：实现简单，维护方便
- 缺点：
    - 额外的内存消耗
    - 可能造成短期的不一致
## 2. 采用布隆过滤器
布隆过滤器其实采用的是**哈希思想**来解决这个问题：
通过一个庞大的二进制数组，走哈希思想去**判断当前这个要查询的这个数据是否存在**。
- 判断存在：放行，这个请求会去访问redis，哪怕此时redis中的数据过期了，但是数据库中一定存在这个数据，在数据库中查询出来这个数据后，再将其放入到redis中，
- 判断不存在：则直接返回
![[CleanShot 2024-02-28 at 11.51.01@2x.png|360]]
### 优缺点分析
- 优点：内存占用较少，没有多余key
- 缺点：
    - 实现复杂
    - 存在误判可能：布隆过滤器走的是哈希思想，只要哈希思想，就可能存在**哈希冲突**。


# 其他思考
---
缓存穿透的解决方案有哪些？
- 缓存null值
- 布隆过滤
- 增强id的复杂度，避免被猜测id规律  （避免直接查很多有效值）
- 做好数据的基础格式校验。   （避免很多猜测id到行为）
- 加强用户权限校验
- 做好热点参数的限流